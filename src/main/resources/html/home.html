<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Todo List Home Page</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #f7f7f7;
			margin: 0;
			padding: 0;
		}

		.header {
			background-color: #fff;
			padding: 20px;
			box-shadow: 0 0 5px #ccc;
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

		.user-info {
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.user-info img {
			width: 40px;
			height: 40px;
			border-radius: 50%;
			margin-right: 10px;
		}

		.user-info p {
			margin: 0;
			font-weight: bold;
		}

		.todo-container {
			background-color: #fff;
			padding: 20px;
			margin: 20px;
			box-shadow: 0 0 5px #ccc;
		}

		.todo-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

		.todo-header h2 {
			margin: 0;
			font-size: 24px;
			font-weight: bold;
		}

		.todo-header button {
			background-color: #4CAF50;
			color: #fff;
			border: none;
			padding: 10px 20px;
			border-radius: 5px;
			font-size: 16px;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.todo-header button:hover {
			background-color: #3e8e41;
		}

		.todo-list {
			margin-top: 20px;
		}

		.todo-item {
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 10px 20px;
			border-bottom: 1px solid #ccc;
		}

		.todo-item:last-child {
			border-bottom: none;
		}

		.todo-item p {
			margin: 0;
			font-size: 16px;
			font-weight: bold;
		}

		.todo-item button {
			background-color: #f44336;
			color: #fff;
			border: none;
			padding: 5px 10px;
			border-radius: 5px;
			font-size: 14px;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.todo-item button:hover {
			background-color: #c62828;
		}
	</style>
</head>

<body>
	<div class="container">
		<div class="header">
			<h1>My Todo List</h1>
			<div class="user-details">
				<p>Welcome, <span id="username"></span>!</p>
				<button class="logout-btn">Logout</button>
			</div>
		</div>
		<button id="button1">Sort By Priority</button>
		<button id="button2">Notify Tasks</button>
		<input type="text" id="searchInput">
		<button id="button3">Search</button>
		<input type="text" id="categoryInput">
		<button id="button4">Category Search</button>
		<button id="button5">Pending Tasks</button>
		<br><br>
		<textarea id="list" rows="2000" cols="500"></textarea>

	</div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
<script>
	// Retrieve user data from localStorage
	const userData = JSON.parse(localStorage.getItem('userData'));
	document.getElementById("username").innerText = userData.email;

	const button1 = document.querySelector('#button1');
	const button2 = document.querySelector('#button2');
	const button3 = document.querySelector('#button3');
	const button4 = document.querySelector('#button4');
	const button5 = document.querySelector('#button5');
	const list = document.querySelector('#list');

	const userId = 1;

	const headers = {
		'userId': userId
	};

	const getList1 = async () => {
		const response = axios.get('http://localhost:8080/tasks?sortBy=priority', {
			headers: headers
		}).then(response => {
			list.value = JSON.stringify(response.data, null, 2);
		});
	};

	const getList2 = async () => {
		const response = axios.get('http://localhost:8080/tasks/notify', {
			headers: headers
		}).then(response => {
			list.value = JSON.stringify(response.data, null, 2);
		});
	};

	const getList3 = async () => {
		const searchKey = document.getElementById("searchInput").value; // Get the current value of the input
		const response = await axios.get(`http://localhost:8080/tasks/search?searchKey=${searchKey}`, {
			headers: headers
		});
		list.value = JSON.stringify(response.data, null, 2);
	};

	const getList4 = async () => {
		const categoryKey = document.getElementById("categoryInput").value; // Get the current value of the input
		const response = await axios.get(`http://localhost:8080/tasks/filter?categoryKey=${categoryKey}`, {
			headers: headers
		});
		list.value = JSON.stringify(response.data, null, 2);
	};
	
	const getList5 = async () => {
		const response = axios.get('http://localhost:8080/tasks/inProgress', {
			headers: headers
		}).then(response => {
			list.value = JSON.stringify(response.data, null, 2);
		});
	};


	button1.addEventListener('click', getList1);
	button2.addEventListener('click', getList2);
	button3.addEventListener('click', getList3);
	button4.addEventListener('click', getList4);
	button5.addEventListener('click', getList5);
</script>

</html>